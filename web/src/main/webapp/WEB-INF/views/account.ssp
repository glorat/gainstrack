#import(com.gainstrack.report._)
#import(com.gainstrack.command._)
#import(com.gainstrack.core._)

<%@ val data: Seq[AccountCommand] %>
<%@ val accountId: AccountId %>
<%@ val urlFor: controllers.MainController.UrlFn %>
<%@ val balanceFor: controllers.AccountController.BalanceFor %>

<table class="queryresults sortable">
<thead>
    <tr>
        <th data-sort="string">account</th>
        <th data-sort="string">date</th>
        <th data-sort="string">type</th>
        <th data-sort="string">description</th>
        <th data-sort="number">balance</th>
    </tr>
</thead>
<tbody>
    #for (cmd <- data)
        <tr>
            <td><a href="<%= urlFor("/gainstrack/command/get/", Seq()) %>/<%= escape(accountId) %>">${accountId}</a></td>
            <td>${cmd.date}</td>
            #match (cmd)
            #case (bal:BalanceAdjustment)
                <td>Balance</td>
            #case (unit:UnitTrustBalance)
                <td>Unit</td>
            #case (tfr:Transfer)
                <td>Transfer</td>
            #case (wrap:CommandWithAccounts[_])
                <td>${wrap.underlying.getClass.getSimpleName}</td>
            #otherwise
                <td>${cmd.getClass.getSimpleName}</td>
            #end
            <td>${cmd.description}</td>
            <td>${balanceFor(cmd)}</td>
        </tr>
    #end
</tbody>
</table>
